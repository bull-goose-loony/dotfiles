################################
##### bat
################################
# colorize man pages
export MANPAGER="sh -c 'awk '\''{ gsub(/\x1B\[[0-9;]*m/, \"\", \$0); gsub(/.\x08/, \"\", \$0); print }'\'' | bat -p -lman'"

# colorize help pages
alias -g -- -h='-h 2>&1 | bat --language=help --style=plain'
alias -g -- --help='--help 2>&1 | bat --language=help --style=plain'

################################
##### fzf
################################
source <(fzf --zsh)

# Open in tmux popup if on tmux, otherwise use --height mode
export FZF_DEFAULT_OPTS="
  --height 40% 
  --tmux 80% 
  --border top"

# Preview file content using bat (https://github.com/sharkdp/bat)
export FZF_CTRL_T_OPTS="
  --walker-skip .git,node_modules,target
  --preview 'bat -n --color=always {}'
  --bind 'ctrl-/:change-preview-window(down|hidden|)'"

# CTRL-Y to copy the command into clipboard using pbcopy
export FZF_CTRL_R_OPTS="
  --bind 'ctrl-y:execute-silent(echo -n {2..} | pbcopy)+abort'
  --color header:italic
  --header 'Press CTRL-Y to copy command into clipboard'"

# Print tree structure in the preview window
export FZF_ALT_C_OPTS="
  --walker-skip .git,node_modules,target
  --preview 'tree -C {}'"

################################
##### ALIASES AND FUNCTIONS 
################################

export KEYMAP_DIR="$HOME/qmk_firmware/keyboards/ergodox_ez/keymaps/zachs_keymap/"
export DOTFILE_DIR="$HOME/.cfg"
export WM_CONF="$HOME/.config/hypr/hyprland.conf" 
export TERM_CONF="$HOME/.config/ghostty/config"

#Resume
alias br='cd ~/resume && pdflatex resume.tex && evince resume.pdf'
alias cd='z'

# General
alias swapscreen='xrandr --output HDMI-1 --left-of DP-2'
alias wmconf='$TEXT_EDITOR $WM_CONF' 
alias why='ncdu'
alias h='history'
alias postgres='sudo -i -u postgres'
alias bdb='psql -U postgres -d budgetdb'
alias bdbload='psql -U postgres -d budgetdb -f /home/zach/src/personal-budget/budget-backend/init_db.sql'
alias down='sudo shutdown now'
alias termconf='$TEXT_EDITOR $TERM_CONF'

# Pacman
alias sps='sudo pacman -S'
alias spsy='sudo pacman -Sy'
alias spsu='sudo pacman -Su'
alias spsyyu='sudo pacman -Syyu'


alias ke='cd $KEYMAP_DIR && vim .'
alias kf='cd $KEYMAP_DIR && qmk flash -kb ergodox_ez -km zachs_keymap && cd -'
alias kc='cd $KEYMAP_DIR && qmk compile -kb ergodox_ez -km zachs_keymap && cd -'

# CONFIGS
alias al='$TEXT_EDITOR $ZSH_ALIAS'
alias ale='cat $ZSH_ALIAS'
alias env='$TEXT_EDITOR $HOME/.zshenv'
alias sauce='source $ZSHRC'
alias vrc='cd $XDG_CONFIG_HOME/nvim; nvim .'

# OVERWRITES
alias grep='rg'
alias h='history'
alias ps='ps -au'
alias vim='$TEXT_EDITOR'
alias psa='ps -au'

# ls
alias ls="eza --icons --git"
alias ll="eza --long --all --git"
alias lt="eza --long --tree --level=3"

# cat
alias cat='bat'

# PROGRAMMING
alias py='python3'

# GIT
alias gco='git checkout'
alias gcob='git checkout -b'
alias gs='git status'
alias gp='git push'
alias ga='git add .'
alias gcm='git commit -m'
alias gd='git diff --name-only --relative --diff-filter=d -z | xargs -0 bat --diff'

# Configs git
alias config='/usr/bin/git --git-dir=$DOTFILE_DIR/ --work-tree=$HOME'
alias cgs='config status'
alias cgp='config push'
alias cga='config add -u'
alias cgc='config commit --allow-empty-message -m ""'

# Start/Enable
alias start='sudo systemctl start'
alias enab='sudo systemctl enable'

# Maven
alias mccp='mvn clean compile package -DSkipTests'
alias mcc='mvn clean compile'
alias mccu='mvn clean compile -U' 
alias mci='mvn clean install'
alias mt='mvn test'
alias mdt='mvn -Dtest='

#Rust
alias ctl='cargo test -- --nocapture' # cargo test print logs

# journal logs since boot
function jb(){
 journalctl -a -b -u "$1" | less +G
}
 
function jub(){
 journalctl --user -a -b -u "$1" | less +G
}
 
# follow journal logs
function jf(){
 journalctl -a -f -u "$1"
}
 
function juf(){
 journalctl --user -a -f -u "$1"
}


alias gacp='gacp.sh'

